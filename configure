#!/bin/bash

set -e

# Generate the antlr4 parser
# TODO

bash build.bash

# Compile program
cmake -B bin
cmake --build bin -j 22

clang -emit-llvm -fno-builtin-printf -fno-builtin-memcpy -fno-builtin-malloc -fno-builtin-strlen -O2 --target=riscv32 lib/builtin.c -S -o bin/builtin.ll
llc --march=riscv32 -mattr=+m,+a build/builtin.ll -opaque-pointers -o bin/builtin.s
